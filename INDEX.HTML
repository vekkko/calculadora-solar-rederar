<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dimensionamiento Inicial Sistema Solar REDERAR</title>
    <!-- Favicon: El ícono en la pestaña del navegador -->
    <link rel="icon" type="image/jpeg" href="https://i.postimg.cc/Pv5PgCWs/LOGO-2024.jpg">
    <!-- Tailwind CSS for styling -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #002244; /* Deep blue from the logo */
        }
        .rederar-yellow {
            color: #FFC107; /* Yellow from the sun in the logo */
        }
        .rederar-blue {
            color: #0056B3; /* A medium blue from the wave in the logo */
        }
        .bg-rederar-blue {
            background-color: #0056B3;
        }
        /* Estilo para botones deshabilitados */
        .disabled-button {
            opacity: 0.6;
            cursor: not-allowed;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <!-- Main Container -->
    <div class="max-w-7xl mx-auto bg-white rounded-2xl shadow-xl overflow-hidden p-6 sm:p-10">
        <!-- Logo and Title -->
        <div class="flex flex-col items-center mb-8">
            <!-- Logo principal de la página -->
            <img src="https://i.postimg.cc/Pv5PgCWs/LOGO-2024.jpg" alt="Logo de REDERAR" class="mb-4 h-24 object-contain rounded-full">
            <h1 class="text-4xl font-extrabold text-center text-gray-800 mb-2">
                DIMENSIONAMIENTO INICIAL SISTEMA SOLAR
            </h1>
            <p class="text-center text-gray-600">Dimensiona tu sistema On-Grid o Off-Grid y solicita una cotización.</p>
        </div>

        <!-- Client Information Section -->
        <div class="bg-rederar-blue p-6 rounded-xl shadow-lg mb-10 border border-blue-600">
            <div class="flex items-center mb-4 text-white">
                <div class="bg-white p-3 rounded-full text-rederar-blue mr-4 shadow-md">
                    <i class="fas fa-user"></i>
                </div>
                <h2 class="text-2xl font-bold">Datos del Cliente</h2>
            </div>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                <div>
                    <label for="clientName" class="block text-sm font-medium text-white">Nombre Completo</label>
                    <input type="text" id="clientName" class="client-input mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-rederar-blue focus:ring-rederar-blue p-2 border" placeholder="Juan Pérez">
                </div>
                <div>
                    <label for="clientPhone" class="block text-sm font-medium text-white">Teléfono</label>
                    <input type="tel" id="clientPhone" class="client-input mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-rederar-blue focus:ring-rederar-blue p-2 border" placeholder="+5493434802264">
                </div>
                <div>
                    <label for="clientAddress" class="block text-sm font-medium text-white">Dirección</label>
                    <input type="text" id="clientAddress" class="client-input mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-rederar-blue focus:ring-rederar-blue p-2 border" placeholder="Av. Siempre Viva 742, Paraná">
                </div>
            </div>
        </div>
        
        <!-- On-Grid and Off-Grid Calculators Container -->
        <div class="grid grid-cols-1 md:grid-cols-2 gap-10">
            <!-- On-Grid Calculator Section -->
            <div class="bg-gray-100 p-6 rounded-xl shadow-lg border border-gray-200">
                <div class="flex items-center mb-4">
                    <div class="bg-rederar-blue p-3 rounded-full text-white mr-4 shadow-md">
                        <i class="fas fa-plug"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-rederar-blue">Sistema On-Grid</h2>
                </div>
                <p class="text-gray-600 mb-6">Calcula el tamaño del sistema solar conectado a la red. Ingresa tu consumo anual y la provincia para obtener la estimación.</p>

                <div class="space-y-4 mb-6">
                    <div>
                        <label for="annualKwh" class="block text-sm font-medium text-gray-700">Consumo anual (kWh)</label>
                        <input type="number" id="annualKwh" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-rederar-blue focus:ring-rederar-blue p-2 border" placeholder="e.g., 3000">
                    </div>
                    <div>
                        <label for="provinceOnGrid" class="block text-sm font-medium text-gray-700">Provincia</label>
                        <select id="provinceOnGrid" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-rederar-blue focus:ring-rederar-blue p-2 border">
                            <option value="">Selecciona una provincia</option>
                        </select>
                    </div>
                </div>

                <div id="onGridResults" class="hidden mt-6 transition-all duration-300">
                    <div id="onGridErrorMessage" class="text-red-600 text-sm font-semibold mb-2"></div>
                    <div id="onGridSuccessContent" class="space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-300">
                        <!-- Results will be dynamically populated here -->
                    </div>
                </div>

                <div class="mt-6 flex flex-col gap-2">
                    <button id="calculateOnGridBtn" onclick="c1()" disabled class="w-full bg-rederar-blue hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 disabled-button">
                        Calcular Sistema On-Grid
                    </button>
                    <!-- Mensaje para indicar al usuario que debe completar los datos del cliente -->
                    <p class="text-sm text-gray-500 text-center">Para calcular el sistema debe tener cargado datos del cliente.</p>
                </div>
                <button onclick="s1()" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 mt-4">
                    <i class="fab fa-whatsapp mr-2"></i> Solicitar Cotización
                </button>
            </div>

            <!-- Off-Grid Calculator Section -->
            <div class="bg-gray-100 p-6 rounded-xl shadow-lg border border-gray-200">
                <div class="flex items-center mb-4">
                    <div class="bg-rederar-blue p-3 rounded-full text-white mr-4 shadow-md">
                        <i class="fas fa-battery-three-quarters"></i>
                    </div>
                    <h2 class="text-2xl font-bold text-rederar-blue">Sistema Off-Grid</h2>
                </div>
                <p class="text-gray-600 mb-6">Calcula los componentes para un sistema aislado. Agrega tus artefactos y selecciona la provincia para obtener la estimación.</p>
                
                <div class="space-y-4 mb-6">
                    <!-- New: Predefined Appliance Selection -->
                    <div>
                        <label for="predefinedAppliances" class="block text-sm font-medium text-gray-700">Seleccionar Artefacto Común</label>
                        <select id="predefinedAppliances" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border" onchange="s3(event)">
                            <option value="">Selecciona un artefacto</option>
                        </select>
                    </div>

                    <div class="border-t border-gray-300 my-4"></div>

                    <!-- Artifact Input Form -->
                    <div class="grid grid-cols-2 sm:grid-cols-4 gap-4 items-end">
                        <div>
                            <label for="applianceName" class="block text-sm font-medium text-gray-700">Nombre</label>
                            <input type="text" id="applianceName" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border" placeholder="e.g., Heladera">
                        </div>
                        <div>
                            <label for="applianceQuantity" class="block text-sm font-medium text-gray-700">Cantidad</label>
                            <input type="number" id="applianceQuantity" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border" placeholder="e.g., 1">
                        </div>
                        <div>
                            <label for="applianceConsumption" class="block text-sm font-medium text-gray-700">Consumo (W)</label>
                            <input type="number" id="applianceConsumption" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border" placeholder="e.g., 100">
                        </div>
                        <div>
                            <label for="applianceHours" class="block text-sm font-medium text-gray-700">Horas/día</label>
                            <input type="number" id="applianceHours" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border" placeholder="e.g., 24">
                        </div>
                        <div class="col-span-2 sm:col-span-4">
                            <button onclick="a1()" class="w-full bg-rederar-blue hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-full shadow-lg transition duration-300">
                                Agregar Artefacto
                            </button>
                        </div>
                    </div>

                    <!-- Artifacts Table -->
                    <div class="overflow-x-auto shadow rounded-lg border border-gray-300">
                        <table class="min-w-full divide-y divide-gray-200">
                            <thead class="bg-gray-200">
                                <tr>
                                    <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Artefacto</th>
                                    <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cant.</th>
                                    <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Consumo (W)</th>
                                    <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Hs/día</th>
                                    <th scope="col" class="px-3 py-2 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Consumo Diario (kWh)</th>
                                    <th scope="col" class="px-3 py-2"></th>
                                </tr>
                            </thead>
                            <tbody id="artifactTableBody" class="bg-white divide-y divide-gray-200">
                                <!-- Table rows will be inserted here by JavaScript -->
                            </tbody>
                        </table>
                    </div>
                </div>

                <div class="space-y-4 mb-6">
                    <div>
                        <label for="totalDailyConsumption" class="block text-sm font-bold text-gray-700">Consumo diario total:</label>
                        <span id="totalDailyConsumption" class="mt-1 text-lg font-bold text-rederar-blue">0.00 kWh</span>
                    </div>
                    <div>
                        <label for="autonomyDays" class="block text-sm font-medium text-gray-700">Días de autonomía de la batería</label>
                        <input type="number" id="autonomyDays" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border" placeholder="e.g., 2">
                    </div>
                    <div>
                        <label for="provinceOffGrid" class="block text-sm font-medium text-gray-700">Provincia</label>
                        <select id="provinceOffGrid" class="mt-1 block w-full rounded-md border-gray-300 shadow-sm p-2 border">
                            <option value="">Selecciona una provincia</option>
                        </select>
                    </div>
                </div>

                <div id="offGridResults" class="hidden mt-6 transition-all duration-300">
                    <div id="offGridErrorMessage" class="text-red-600 text-sm font-semibold mb-2"></div>
                    <div id="offGridSuccessContent" class="space-y-3 p-4 bg-blue-50 rounded-lg border border-blue-300">
                        <!-- Results will be dynamically populated here -->
                    </div>
                </div>
                
                <div class="mt-6 flex flex-col gap-2">
                    <button id="calculateOffGridBtn" onclick="c2()" disabled class="w-full bg-rederar-blue hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 disabled-button">
                        Calcular Sistema Off-Grid
                    </button>
                    <!-- Mensaje para indicar al usuario que debe completar los datos del cliente -->
                    <p class="text-sm text-gray-500 text-center">Para calcular el sistema debe tener cargado datos del cliente.</p>
                </div>
                <button onclick="s2()" class="w-full bg-green-500 hover:bg-green-600 text-white font-bold py-3 px-6 rounded-full shadow-lg transition duration-300 mt-4">
                    <i class="fab fa-whatsapp mr-2"></i> Solicitar Cotización
                </button>
            </div>
        </div>
    </div>

    <!-- Footer with Logo and Copyright -->
    <footer class="mt-10 py-6 text-center text-white bg-rederar-blue rounded-xl max-w-7xl mx-auto shadow-inner border border-blue-600">
        <div class="flex justify-center items-center mb-2">
            <!-- Logo de REDERAR en el pie de página -->
            <img src="https://i.postimg.cc/Pv5PgCWs/LOGO-2024.jpg" alt="Logo de REDERAR" class="h-16 object-contain rounded-full">
        </div>
        <p class="text-sm text-gray-300">&copy; 2024 REDERAR. Todos los derechos reservados.</p>
    </footer>

    <!-- Custom Alert Modal -->
    <div id="custom-alert-modal" class="fixed inset-0 z-50 flex items-center justify-center bg-gray-900 bg-opacity-50 hidden">
        <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full mx-4">
            <h3 class="text-lg font-bold text-gray-800 mb-4">Aviso</h3>
            <p id="custom-alert-message" class="text-gray-700 mb-6"></p>
            <button onclick="closeAlert()" class="w-full bg-rederar-blue hover:bg-blue-700 text-white font-bold py-2 rounded-full transition duration-300">
                Aceptar
            </button>
        </div>
    </div>

    <script>
        // --- CÓDIGO JS OFUSCADO ---
        // Este código realiza las mismas funciones que el original, pero las variables y nombres de funciones
        // han sido cambiados para dificultar su lectura y comprensión.

        const d1 = {
            'buenos-aires': { name: 'Buenos Aires', hsp: 4.5, localidades: ['La Plata', 'Mar del Plata', 'Bahía Blanca', 'Tandil', 'Zárate', 'San Nicolás', 'Junín', 'Olavarría', 'Pergamino'] },
            'cordoba': { name: 'Córdoba', hsp: 4.9, localidades: ['Córdoba Capital', 'Villa Carlos Paz', 'Río Cuarto', 'San Francisco', 'Villa María', 'Río Tercero'] },
            'santa-fe': { name: 'Santa Fe', hsp: 4.7, localidades: ['Santa Fe Capital', 'Rosario', 'Reconquista', 'Venado Tuerto', 'Rafaela', 'Esperanza'] },
            'mendoza': { name: 'Mendoza', hsp: 5.6, localidades: ['Mendoza Capital', 'San Rafael', 'Malargüe', 'General Alvear', 'Tunuyán', 'Godoy Cruz'] },
            'tucuman': { name: 'Tucumán', hsp: 5.1, localidades: ['San Miguel de Tucumán', 'Yerba Buena', 'Concepción', 'Tafí Viejo', 'Alderetes'] },
            'entre-rios': { name: 'Entre Ríos', hsp: 4.8, localidades: ['Paraná', 'Concordia', 'Gualeguaychú', 'Villaguay', 'La Paz', 'Victoria'] },
            'salta': { name: 'Salta', hsp: 5.5, localidades: ['Salta Capital', 'Orán', 'Cafayate', 'Tartagal', 'Metán', 'Rosario de la Frontera'] },
            'corrientes': { name: 'Corrientes', hsp: 4.6, localidades: ['Corrientes Capital', 'Goya', 'Paso de los Libres', 'Mercedes', 'Curuzú Cuatiá', 'Santo Tomé'] },
            'misiones': { name: 'Misiones', hsp: 4.6, localidades: ['Posadas', 'Iguazú', 'Oberá', 'Eldorado', 'Apóstoles', 'Puerto Rico'] },
            'chaco': { name: 'Chaco', hsp: 4.9, localidades: ['Resistencia', 'Sáenz Peña', 'Villa Ángela', 'Castelli', 'Charata', 'Quitilipi'] },
            'santiago-del-estero': { name: 'Santiago del Estero', hsp: 5.3, localidades: ['Santiago del Estero Capital', 'La Banda', 'Termas de Río Hondo', 'Frías', 'Loreto'] },
            'san-juan': { name: 'San Juan', hsp: 5.8, localidades: ['San Juan Capital', 'Rivadavia', 'Caucete', 'Jáchal', 'Albardón', 'San Martín'] },
            'san-luis': { name: 'San Luis', hsp: 5.2, localidades: ['San Luis Capital', 'Villa Mercedes', 'Merlo', 'La Punta', 'Santa Rosa del Conlara'] },
            'catamarca': { name: 'Catamarca', hsp: 5.4, localidades: ['San Fernando del Valle de Catamarca', 'Andalgalá', 'Tinogasta', 'Belén', 'Recreo', 'Fray Mamerto Esquiú'] },
            'la-rioja': { name: 'La Rioja', hsp: 5.7, localidades: ['La Rioja Capital', 'Chilecito', 'Arauco', 'Chamical', 'Chepes'] },
            'jujuy': { name: 'Jujuy', hsp: 5.6, localidades: ['San Salvador de Jujuy', 'Palpalá', 'La Quiaca', 'Perico', 'Libertador General San Martín'] },
            'la-pampa': { name: 'La Pampa', hsp: 5.1, localidades: ['Santa Rosa', 'General Pico', 'Toay', 'Eduardo Castex', 'Victorica'] },
            'neuquen': { name: 'Neuquén', hsp: 4.2, localidades: ['Neuquén Capital', 'San Martín de los Andes', 'Villa La Angostura', 'Cutral Có', 'Plottier'] },
            'rio-negro': { name: 'Río Negro', hsp: 4.4, localidades: ['Viedma', 'Bariloche', 'General Roca', 'Cipolletti', 'San Antonio Oeste'] },
            'chubut': { name: 'Chubut', hsp: 4.3, localidades: ['Rawson', 'Comodoro Rivadavia', 'Puerto Madryn', 'Trelew', 'Esquel'] },
            'santa-cruz': { name: 'Santa Cruz', hsp: 3.9, localidades: ['Río Gallegos', 'Caleta Olivia', 'El Calafate', 'Pico Truncado', 'Las Heras'] },
            'tierra-del-fuego': { name: 'Tierra del Fuego', hsp: 3.5, localidades: ['Ushuaia', 'Río Grande', 'Tolhuin'] },
            'formosa': { name: 'Formosa', hsp: 4.8, localidades: ['Formosa Capital', 'Clorinda', 'El Colorado', 'Pirané', 'Ingeniero Juárez'] }
        };
        const p1 = 550; // W
        const i1 = 2; // kW
        const i2 = [2, 3, 4, 5, 6, 8, 10]; // Common inverter sizes in kW
        const a2 = {
            'heladera': { name: 'Heladera', consumption: 100, hours: 24, quantity: 1 },
            'televisor-led': { name: 'Televisor LED (42")', consumption: 80, hours: 4, quantity: 1 },
            'luces-led': { name: 'Luces LED (10W)', consumption: 10, hours: 6, quantity: 5 },
            'notebook': { name: 'Notebook', consumption: 50, hours: 8, quantity: 1 },
            'microondas': { name: 'Microondas', consumption: 1200, hours: 0.25, quantity: 1 },
            'bomba-agua': { name: 'Bomba de agua', consumption: 500, hours: 1, quantity: 1 },
            'cargador-celular': { name: 'Cargador de celular', consumption: 10, hours: 3, quantity: 1 }
        };
        function sA(m) {
            document.getElementById('custom-alert-message').innerText = m;
            document.getElementById('custom-alert-modal').classList.remove('hidden');
        }
        function closeAlert() {
            document.getElementById('custom-alert-modal').classList.add('hidden');
        }
        document.addEventListener('DOMContentLoaded', () => {
            p1_1('provinceOnGrid');
            p1_1('provinceOffGrid');
            p2_1();
            const e = document.querySelectorAll('.client-input');
            e.forEach(i => {
                i.addEventListener('input', c4);
            });
            c4();
        });
        function c4() {
            const n = document.getElementById('clientName').value.trim();
            const t = document.getElementById('clientPhone').value.trim();
            const d = document.getElementById('clientAddress').value.trim();
            const c = n !== '' && t !== '' && d !== '';
            const b1 = document.getElementById('calculateOnGridBtn');
            const b2 = document.getElementById('calculateOffGridBtn');
            if (c) {
                b1.disabled = false;
                b1.classList.remove('disabled-button');
                b2.disabled = false;
                b2.classList.remove('disabled-button');
            } else {
                b1.disabled = true;
                b1.classList.add('disabled-button');
                b2.disabled = true;
                b2.classList.add('disabled-button');
            }
        }
        function p1_1(s) {
            const p = document.getElementById(s);
            if (!p) return;
            p.innerHTML = '<option value="">Selecciona una provincia</option>';
            for (const k in d1) {
                const o = document.createElement('option');
                o.value = k;
                o.textContent = d1[k].name;
                p.appendChild(o);
            }
        }
        function p2_1() {
            const p = document.getElementById('predefinedAppliances');
            if (!p) return;
            for (const k in a2) {
                const o = document.createElement('option');
                o.value = k;
                o.textContent = a2[k].name;
                p.appendChild(o);
            }
        }
        function s3(e) {
            const a = e.target.value;
            if (!a) {
                document.getElementById('applianceName').value = '';
                document.getElementById('applianceQuantity').value = '';
                document.getElementById('applianceConsumption').value = '';
                document.getElementById('applianceHours').value = '';
                return;
            }
            const o = a2[a];
            if (o) {
                document.getElementById('applianceName').value = o.name;
                document.getElementById('applianceQuantity').value = o.quantity;
                document.getElementById('applianceConsumption').value = o.consumption;
                document.getElementById('applianceHours').value = o.hours;
            }
        }
        function c1() {
            const k = parseFloat(document.getElementById('annualKwh').value);
            const p = document.getElementById('provinceOnGrid').value;
            const r = document.getElementById('onGridResults');
            const m = document.getElementById('onGridErrorMessage');
            const c = document.getElementById('onGridSuccessContent');
            if (isNaN(k) || k <= 0 || !p) {
                r.classList.remove('hidden');
                m.innerText = 'Por favor, ingresa un consumo anual válido y selecciona una provincia.';
                c.classList.add('hidden');
                return false;
            }
            m.innerText = '';
            c.classList.remove('hidden');
            r.classList.remove('hidden');
            const s = 0.85;
            const h = d1[p].hsp;
            const i3 = (k / (h * 365 * s));
            const n = Math.ceil((i3 * 1000) / p1);
            const t = (n * p1 / 1000).toFixed(2);
            let i4 = i2.find(z => z >= i3);
            if (!i4 || i4 < i1) {
                i4 = i2.find(z => z >= i1);
            }
            const g = t * h * 365 * s;
            c.innerHTML = `
                <p id="onGridPanelResult" class="text-rederar-blue font-semibold">Cantidad de paneles solares (550Wp): ${n} (Potencia total: ${t} kWp)</p>
                <p id="onGridInverterResult" class="text-rederar-blue font-semibold">Tamaño del inversor On-Grid: ${i4} kW</p>
                <p id="onGridGenerationResult" class="text-rederar-blue font-semibold">Este sistema podría generar hasta ${g.toFixed(0)} kWh anualmente, cubriendo tu consumo actual.</p>
                <p class="text-gray-600 italic mt-4">**Importante:** Esta es una estimación inicial. Los valores pueden variar según las condiciones reales y el diseño final del sistema.</p>
            `;
            return true;
        }
        function s1() {
            const n = document.getElementById('clientName').value.trim();
            const t = document.getElementById('clientPhone').value.trim();
            const d = document.getElementById('clientAddress').value.trim();
            if (!n || !t || !d) {
                sA('Por favor, completa los datos del cliente antes de solicitar una cotización.');
                return;
            }
            if (!c1()) {
                return;
            }
            const k = document.getElementById('annualKwh').value;
            const p = document.getElementById('provinceOnGrid').options[document.getElementById('provinceOnGrid').selectedIndex].text;
            const pr = document.getElementById('onGridPanelResult').innerText;
            const ir = document.getElementById('onGridInverterResult').innerText;
            const gr = document.getElementById('onGridGenerationResult').innerText;
            const m = `*SOLICITUD DE COTIZACIÓN ON-GRID*\n\n` +
                `*Datos del Cliente:*\n` +
                `Nombre: ${n}\n` +
                `Teléfono: ${t}\n` +
                `Dirección: ${d}\n` +
                `Provincia: ${p}\n\n` +
                `*Dimensionamiento Inicial:*\n` +
                `Consumo anual: ${k} kWh\n` +
                `${pr}\n` +
                `${ir}\n` +
                `${gr}\n`;
            const em = encodeURIComponent(m);
            const w = `https://api.whatsapp.com/send?phone=+543434802264&text=${em}`;
            window.open(w, '_blank');
        }
        function c2() {
            const t = document.getElementById('totalDailyConsumption');
            const d = parseFloat(t.innerText.replace(' kWh', ''));
            const a = parseFloat(document.getElementById('autonomyDays').value);
            const p = document.getElementById('provinceOffGrid').value;
            const r = document.getElementById('offGridResults');
            const m = document.getElementById('offGridErrorMessage');
            const c = document.getElementById('offGridSuccessContent');
            if (isNaN(d) || d <= 0 || isNaN(a) || a <= 0 || !p) {
                r.classList.remove('hidden');
                m.innerText = 'Por favor, agrega al menos un artefacto y completa todos los campos con valores válidos.';
                c.classList.add('hidden');
                return false;
            }
            m.innerText = '';
            c.classList.remove('hidden');
            r.classList.remove('hidden');
            const s = 0.8;
            const b = 0.85;
            const h = d1[p].hsp;
            const bz = ((d * a) / b).toFixed(2);
            const ps = ((d / (h * s)) * 1.2);
            const np = Math.ceil((ps * 1000) / p1);
            const tp = (np * p1 / 1000).toFixed(2);
            let i3 = i2.find(z => z >= ps);
            if (!i3 || i3 < i1) {
                i3 = i2.find(z => z >= i1);
            }
            c.innerHTML = `
                <p id="offGridPanelResult" class="text-rederar-blue font-semibold">Cantidad de paneles solares (550Wp): ${np} (Potencia total: ${tp} kWp)</p>
                <p id="offGridInverterResult" class="text-rederar-blue font-semibold">Tamaño del inversor Off-Grid: ${i3} kW</p>
                <p id="offGridBatteryResult" class="text-rederar-blue font-semibold">Capacidad del banco de baterías: ${bz} kWh</p>
                <p class="text-gray-600 italic mt-4">**Importante:** Esta es una estimación inicial. Los valores pueden variar según las condiciones reales y el diseño final del sistema.</p>
            `;
            return true;
        }
        function s2() {
            const n = document.getElementById('clientName').value.trim();
            const t = document.getElementById('clientPhone').value.trim();
            const d = document.getElementById('clientAddress').value.trim();
            if (!n || !t || !d) {
                sA('Por favor, completa los datos del cliente antes de solicitar una cotización.');
                return;
            }
            if (!c2()) {
                return;
            }
            const tdc = document.getElementById('totalDailyConsumption');
            const dk = parseFloat(tdc.innerText.replace(' kWh', ''));
            const a = document.getElementById('autonomyDays').value;
            const p = document.getElementById('provinceOffGrid').options[document.getElementById('provinceOffGrid').selectedIndex].text;
            const pr = document.getElementById('offGridPanelResult').innerText;
            const ir = document.getElementById('offGridInverterResult').innerText;
            const br = document.getElementById('offGridBatteryResult').innerText;
            let al = '';
            const tr = document.querySelectorAll('#artifactTableBody tr');
            tr.forEach(r => {
                const c = r.querySelectorAll('td');
                const n = c[0].innerText;
                const q = c[1].innerText;
                const co = c[2].innerText;
                const h = c[3].innerText;
                const dc = c[4].innerText;
                al += ` - ${q}x ${n} (${co}W, ${h}hs/día) = ${dc}\n`;
            });
            if (al === '') {
                al = 'No se han agregado artefactos.\n';
            }
            const m = `*SOLICITUD DE COTIZACIÓN OFF-GRID*\n\n` +
                `*Datos del Cliente:*\n` +
                `Nombre: ${n}\n` +
                `Teléfono: ${t}\n` +
                `Dirección: ${d}\n` +
                `Provincia: ${p}\n\n` +
                `*Artefactos a Suministrar:*\n` +
                al +
                `*Dimensionamiento Inicial:*\n` +
                `Consumo diario total: ${dk.toFixed(2)} kWh\n` +
                `Autonomía de baterías: ${a} días\n` +
                `${pr}\n` +
                `${ir}\n` +
                `${br}\n`;
            const em = encodeURIComponent(m);
            const w = `https://api.whatsapp.com/send?phone=+543434802264&text=${em}`;
            window.open(w, '_blank');
        }
        function a1() {
            const n = document.getElementById('applianceName');
            const q = document.getElementById('applianceQuantity');
            const co = document.getElementById('applianceConsumption');
            const h = document.getElementById('applianceHours');
            const v_n = n.value.trim();
            const v_q = parseFloat(q.value);
            const v_co = parseFloat(co.value);
            const v_h = parseFloat(h.value);
            if (!v_n || isNaN(v_q) || v_q <= 0 || isNaN(v_co) || v_co <= 0 || isNaN(v_h) || v_h <= 0) {
                sA('Por favor, completa todos los campos con valores válidos para agregar un artefacto.');
                return;
            }
            let c_h = v_h;
            if (v_n.toLowerCase() === 'heladera' && v_h === 24) {
                c_h = 8;
            }
            const dk = (v_q * v_co * c_h / 1000).toFixed(2);
            const tb = document.getElementById('artifactTableBody');
            const nr = document.createElement('tr');
            nr.classList.add('bg-white');
            nr.innerHTML = `
                <td class="px-3 py-2 whitespace-nowrap text-sm font-medium text-gray-900">${v_n}</td>
                <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-500">${v_q}</td>
                <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-500">${v_co}</td>
                <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-500">${c_h}</td>
                <td class="px-3 py-2 whitespace-nowrap text-sm text-gray-500" data-daily-kwh="${dk}">${dk} kWh</td>
                <td class="px-3 py-2 whitespace-nowrap text-sm font-medium">
                    <button onclick="r1(this)" class="text-red-600 hover:text-red-900">Eliminar</button>
                </td>
            `;
            tb.appendChild(nr);
            n.value = '';
            q.value = '';
            co.value = '';
            h.value = '';
            document.getElementById('predefinedAppliances').value = '';
            c3();
        }
        function r1(b) {
            const r = b.closest('tr');
            r.remove();
            c3();
        }
        function c3() {
            const tr = document.querySelectorAll('#artifactTableBody tr');
            let tc = 0;
            tr.forEach(r => {
                const kwhc = r.querySelector('[data-daily-kwh]');
                if (kwhc) {
                    tc += parseFloat(kwhc.dataset.dailyKwh);
                }
            });
            document.getElementById('totalDailyConsumption').innerText = `${tc.toFixed(2)} kWh`;
        }
    </script>
</body>
</html>

